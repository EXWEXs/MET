<?xml version="1.0"?>
<!DOCTYPE met_test
[
  <!ENTITY MET_DIR        "/d3/projects/MET/MET_development/svn-met-dev.cgd.ucar.edu/trunk/met">
  <!ENTITY TEST_DIR       "/d3/projects/MET/MET_test/test">
  <!ENTITY CONFIG_DIR     "&TEST_DIR;/config">
  <!ENTITY DATA_DIR       "/d3/projects/MET/MET_test_data/unit_test">
  
  <!ENTITY DATA_DIR_MODEL "&DATA_DIR;/model_data">
  <!ENTITY DATA_DIR_OBS   "&DATA_DIR;/obs_data">
  <!ENTITY DATA_DIR_OUT   "&DATA_DIR;/output">
]>

<met_test>

  <test_dir>&TEST_DIR;</test_dir>
  <exit_on_fail>true</exit_on_fail>


  <!--                                    -->
  <!--  point_stat                        -->
  <!--                                    -->

  <test name="point_stat_GRIB1_NAM_GDAS">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>         <value>-1800</value></pair>
      <pair><name>END_DS</name>         <value>1800</value></pair>
      <pair><name>MASK_POLY_FILE</name> <value>&DATA_DIR_MODEL;/grib1/nam/nam_2012040900_F012.grib {name="LAND";level="L0";}</value></pair>
      <pair><name>OUTPUT_PREFIX</name>  <value>GRIB1_NAM_NDAS</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/grib1/nam/nam_2012040900_F012.grib \
      &DATA_DIR_OUT;/pb2nc/gdas1.20120409.t12z.prepbufr.nc \
      &CONFIG_DIR;/PointStatConfig_PHYS \
      -climo &DATA_DIR_MODEL;/grib1/gfs/gfs_2012040900_F012_gNam.grib \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>   
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_sl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_sal1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_vl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_val1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_NDAS_120000L_20120409_120000V_mpr.txt</stat>
    </output>
  </test>
  
  <test name="point_stat_GRIB2_NAM_NDAS">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>         <value>-1800</value></pair>
      <pair><name>END_DS</name>         <value>1800</value></pair>
      <pair><name>MASK_POLY_FILE</name> <value>&DATA_DIR_MODEL;/grib2/nam/nam_2012040900_F012.grib2 {name="LAND";level="L0";}</value></pair>
      <pair><name>OUTPUT_PREFIX</name>  <value>GRIB2_NAM_NDAS</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/grib2/nam/nam_2012040900_F012.grib2 \
      &DATA_DIR_OUT;/pb2nc/ndas.20120409.t12z.prepbufr.tm00.nr \
      &CONFIG_DIR;/PointStatConfig_PHYS \
      -climo &DATA_DIR_MODEL;/grib2/gfs/gfs_2012040900_F012_gNam.grib2 \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>   
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_sl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_sal1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_vl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_val1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_NAM_NDAS_120000L_20120409_120000V_mpr.txt</stat>
    </output>
  </test>
  
  <test name="point_stat_GRIB2_SREF_GDAS">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>         <value>-1800</value></pair>
      <pair><name>END_DS</name>         <value>1800</value></pair>
      <pair><name>MASK_POLY_FILE</name> <value>&DATA_DIR_MODEL;/grib2/sref_mn/sref_mean_2012040821_F015.grib2 {name="TMP";level="Z2";} &lt;280</value></pair>
      <pair><name>OUTPUT_PREFIX</name>  <value>GRIB2_SREF_NDAS</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/grib2/sref_mn/sref_mean_2012040821_F015.grib2 \
      &DATA_DIR_OUT;/pb2nc/gdas/gdas1.20120409.t12z.prepbufr.nc \
      &CONFIG_DIR;/PointStatConfig_PHYS \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_sl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_vl1l2.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_NDAS_150000L_20120409_120000V_mpr.txt</stat>
    </output>
  </test>
  
  <test name="point_stat_GRIB1_NAM_TRMM">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>           <value>-1800</value></pair>
      <pair><name>END_DS</name>           <value>1800</value></pair>
      <pair><name>FCST_FIELD_NAME</name>  <value>APCP</value></pair>
      <pair><name>FCST_FIELD_LEVEL</name> <value>A3</value></pair>
      <pair><name>OBS_DICT</name>         <value>fcst</value></pair>
      <pair><name>OUTPUT_PREFIX</name>    <value>GRIB1_NAM_TRMM</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/grib1/nam/nam_2012040900_F012.grib \
      &DATA_DIR_OUT;/ascii2nc/trmm_2012040912_3hr.nc \
      &CONFIG_DIR;/PointStatConfig_APCP \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB1_NAM_TRMM_120000L_20120409_120000V_sl1l2.txt</stat>
    </output>
  </test>
  
  <test name="point_stat_GRIB2_SREF_TRMM">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>           <value>-1800</value></pair>
      <pair><name>END_DS</name>           <value>1800</value></pair>
      <pair><name>FCST_FIELD_NAME</name>  <value>APCP</value></pair>
      <pair><name>FCST_FIELD_LEVEL</name> <value>A3</value></pair>
      <pair><name>OBS_DICT</name>         <value>fcst</value></pair>
      <pair><name>OUTPUT_PREFIX</name>    <value>GRIB2_SREF_TRMM</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/grib2/sref_mn/sref_mean_2012040821_F012.grib2 \
      &DATA_DIR_OUT;/ascii2nc/trmm_2012040912_3hr.nc \
      &CONFIG_DIR;/PointStatConfig_APCP \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_GRIB2_SREF_TRMM_150000L_20120409_120000V_sl1l2.txt</stat>
    </output>
  </test>

  <test name="point_stat_NCMET_NAM_HMTGAGE">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>           <value>-1800</value></pair>
      <pair><name>END_DS</name>           <value>1800</value></pair>
      <pair><name>FCST_FIELD_NAME</name>  <value>APCP_24</value></pair>
      <pair><name>FCST_FIELD_LEVEL</name> <value>(*,*)</value></pair>
      <pair><name>OBS_DICT</name>         <value>{ field = [
                                                     { name         = "APCP";
                                                       level        = "A24";
                                                       cat_thresh   = [ >0.254, >0.635, >1.270, >2.540 ];
                                                       message_type = "ADPSFC";
                                                     }
                                                   ]; }</value></pair>
      <pair><name>OUTPUT_PREFIX</name>    <value>NCMET_NAM_HMTGAGE</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/met_nc/nam/nam_2012040900_F036_APCP24.nc \
      &DATA_DIR_OUT;/ascii2nc/gauge_2012041012_24hr.nc \
      &CONFIG_DIR;/PointStatConfig_APCP \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCMET_NAM_HMTGAGE_360000L_20120410_120000V_sl1l2.txt</stat>
    </output>
  </test>

  <test name="point_stat_NCPINT_TRMM">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>           <value>-1800</value></pair>
      <pair><name>END_DS</name>           <value>1800</value></pair>
      <pair><name>FCST_FIELD_NAME</name>  <value>RAINNC</value></pair>
      <pair><name>FCST_FIELD_LEVEL</name> <value>(0,*,*)</value></pair>
      <pair><name>OBS_DICT</name>         <value>{ field = [
                                                     { name         = "APCP";
                                                       level        = "A12";
                                                       cat_thresh   = [ >0.254, >0.635, >1.270, >2.540 ];
                                                       message_type = "ADPSFC";
                                                     }
                                                   ]; }</value></pair>
      <pair><name>OUTPUT_PREFIX</name>    <value>NCPINT_TRMM</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/p_interp/wrfout_d01_2008-08-08_12:00:00_PLEV \
      &DATA_DIR_OUT;/ascii2nc/trmm_2012040912_3hr.nc \
      &CONFIG_DIR;/PointStatConfig_APCP \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_TRMM_240000L_20080808_120000V_sl1l2.txt</stat>
    </output>
  </test>

  <test name="point_stat_NCPINT_NDAS">
    <exec>&MET_DIR;/bin/point_stat</exec>
    <env>
      <pair><name>BEG_DS</name>           <value>-150000000</value></pair>
      <pair><name>END_DS</name>           <value>1800</value></pair>
      <pair><name>OUTPUT_PREFIX</name>    <value>NCPINT_NDAS</value></pair>
    </env>
    <param> \
      &DATA_DIR_MODEL;/p_interp/wrfout_d01_2008-08-08_12:00:00_PLEV \
      &DATA_DIR_OUT;/pb2nc/ndas.20120409.t12z.prepbufr.tm00.nr \
      &CONFIG_DIR;/PointStatConfig_PHYS_pint \
      -outdir &DATA_DIR_OUT;/point_stat -v 1
    </param>
    <output>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V.stat</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V_fho.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V_ctc.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V_cts.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V_cnt.txt</stat>
      <stat>&DATA_DIR_OUT;/point_stat/point_stat_NCPINT_NDAS_240000L_20080808_120000V_sl1l2.txt</stat>
    </output>
  </test>

</met_test>
